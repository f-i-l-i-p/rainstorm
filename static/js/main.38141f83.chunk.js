(this.webpackJsonprainstorm=this.webpackJsonprainstorm||[]).push([[0],{124:function(e,t,r){},125:function(e,t,r){},130:function(e,t,r){},131:function(e,t,r){},133:function(e,t,r){},203:function(e,t,r){"use strict";r.r(t),t.default=r.p+"static/media/day_clear_sky.3cec5a70.svg"},204:function(e,t,r){"use strict";r.r(t),t.default=r.p+"static/media/light_rain.521dfb24.svg"},205:function(e,t,r){},206:function(e,t,r){},212:function(e,t,r){"use strict";r.r(t);var a,n=r(0),s=r.n(n),c=r(18),o=r.n(c),i=(r(124),r(125),r(25)),u=r(26),l=r(32),h=r(31),d=r(55),p=r(19),f=r.n(p),b=r(30),v="FORECAST_FETCH_START",j="FORECAST_FETCH_SUCCESS",m="FORECAST_FETCH_FAILURE",g="SET_DISPLAY_TIMES",y=r.p+"static/media/SMHI.147242e8.jpg";!function(e){e.unknown="unknown",e.clear_sky="clear_sky",e.nearly_clear_sky="nearly_clear_sky",e.half_clear_sky="half_clear_sky",e.cloudy_sky="cloudy_sky",e.overcast="overcast",e.light_rain="light_rain",e.moderate_rain="moderate_rain",e.heavy_rain="heavy_rain"}(a||(a={}));var w=function(){function e(t,r){Object(i.a)(this,e),this.name=void 0,this.logo=void 0,this.name=t,this.logo=r}return Object(u.a)(e,[{key:"fetchForecast",value:function(){var e=Object(b.a)(f.a.mark((function e(t,r,a){var n,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.requestData(t.lat.toString(),t.long.toString());case 3:return s=e.sent,e.next=6,this.formatResponse(s);case 6:n=e.sent,e.next=14;break;case 9:return e.prev=9,e.t0=e.catch(0),console.error(e.t0),a(e.t0),e.abrupt("return");case 14:r(n);case 15:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,r,a){return e.apply(this,arguments)}}()}]),e}(),O=function(e){Object(l.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.call(this,"Yr",y)).icons={lightrain:a.light_rain,rain:a.moderate_rain,clearsky_night:a.clear_sky,partlycloudy_day:a.half_clear_sky,partlycloudy_night:a.half_clear_sky,cloudy:a.cloudy_sky},e}return Object(u.a)(r,[{key:"requestData",value:function(){var e=Object(b.a)(f.a.mark((function e(t,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.met.no/weatherapi/locationforecast/2.0/compact?lat="+t+"&lon="+r);case 2:if((a=e.sent).ok){e.next=5;break}throw new Error("Weather response error! status: "+a.status);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"formatResponse",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var r,n,s,c,o,i,u,l,h;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={weatherPoints:[]},e.next=3,t.json();case 3:n=e.sent,s=n.properties.timeseries,c=(new Date).getTime(),o=0;case 7:if(!(o<s.length)){e.next=33;break}if(i=s[o],!((u=new Date(i.time)).getTime()<c)){e.next=12;break}return e.abrupt("continue",30);case 12:if(l=void 0,!i.data.next_1_hours){e.next=17;break}l=i.data.next_1_hours.summary.symbol_code,e.next=26;break;case 17:if(!i.data.next_6_hours){e.next=21;break}l=i.data.next_6_hours.summary.symbol_code,e.next=26;break;case 21:if(!i.data.next_12_hours){e.next=25;break}l=i.data.next_12_hours.summary.symbol_code,e.next=26;break;case 25:return e.abrupt("continue",30);case 26:(this.icons[l]||a.unknown)===a.unknown&&console.warn("Unknown symbol",l),h={temperature:i.data.instant.details.air_temperature,wind:i.data.instant.details.wind_speed,gust:NaN,symbol:this.icons[l]||a.unknown},r.weatherPoints.push({time:u,weather:h});case 30:o++,e.next=7;break;case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),r}(w),x=function(e){Object(l.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(i.a)(this,r),(e=t.call(this,"SMHI",y)).icons={1:a.clear_sky,2:a.nearly_clear_sky,3:a.half_clear_sky,4:a.half_clear_sky,5:a.cloudy_sky,6:a.overcast,18:a.light_rain,19:a.moderate_rain},e}return Object(u.a)(r,[{key:"requestData",value:function(){var e=Object(b.a)(f.a.mark((function e(t,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 9,e.next=3,fetch("https://opendata-download-metfcst.smhi.se/api/category/pmp3g/version/2/geotype/point/lon/"+r.substr(0,9)+"/lat/"+t.substr(0,9)+"/data.json");case 3:if((a=e.sent).ok){e.next=6;break}throw new Error("Weather response error! status: ' + result.status");case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"formatResponse",value:function(){var e=Object(b.a)(f.a.mark((function e(t){var r,n,s,c,o=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={weatherPoints:[]},e.next=3,t.json();case 3:return n=e.sent,s=n.timeSeries,c=(new Date).getTime(),s.forEach((function(e){var t=new Date(e.validTime);if(t.getTime()>=c){var n=e.parameters,s={temperature:NaN,wind:NaN,gust:NaN,symbol:a.unknown};n.forEach((function(e){var t=e.values[0];switch(e.name){case"t":s.temperature=t;break;case"ws":s.wind=t;break;case"gust":s.gust=t;break;case"Wsymb2":if(!o.icons[t]){console.warn("Unknown symbol value",t),s.symbol=a.unknown;break}s.symbol=o.icons[t]}})),r.weatherPoints.push({time:t,weather:s})}})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),r}(w),k=[new x,new O];function _(){return k}function S(e){return{type:v,provider:e}}function T(e,t){return{type:j,forecast:t,provider:e}}function N(e,t){return{type:m,errorMessage:t,provider:e}}r(130),r(131);var C=r(6),E=function(e){return Object(C.jsx)("div",{className:"paper",style:e.style,children:e.children})},L=r(216),D=(r(133),L.a.Text);console.log(r(203));var F=function(e){return Object(C.jsx)("div",{className:"weather_cell",children:void 0!=e.weather&&Object(C.jsxs)(s.a.Fragment,{children:[Object(C.jsxs)(D,{strong:!0,children:[Math.round(e.weather.temperature)," \xb0C"]}),e.weather.symbol&&Object(C.jsx)("img",{className:"weather_symbol",src:r(204).default}),Object(C.jsxs)("div",{children:[Object(C.jsx)(D,{strong:!0,children:Math.round(e.weather.wind)}),Object(C.jsxs)(D,{type:"secondary",children:[" (",Math.round(e.weather.gust),") "]}),Object(C.jsx)(D,{strong:!0,children:"m/s"})]})]})})},M=r(214),R=(r(205),L.a.Text),A=function(e){return Object(C.jsx)("div",{className:"time_cell",children:Object(C.jsx)(R,{strong:!0,children:("0"+e.time.getHours()).slice(-2)})})},P=(r(206),function(e){Object(l.a)(r,e);var t=Object(h.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){var e=this;return Object(C.jsxs)("div",{children:[this.props.name,Object(C.jsxs)("div",{className:"columns",children:[Object(C.jsx)("div",{className:"right-column",children:Object(C.jsx)("div",{className:"time-row",style:{width:"100%"},children:Object(C.jsx)(E,{style:{width:"100%",height:"100%"}})})}),Object(C.jsxs)("div",{className:"all-columns",children:[Object(C.jsx)("div",{className:"time-row"}),this.props.tableData.providers.map((function(e,t){return Object(C.jsx)("div",{className:"weather-row",children:Object(C.jsx)(E,{style:{width:"100%",height:"100%"}})},t)}))]}),Object(C.jsxs)("div",{className:"left-column",children:[Object(C.jsx)("div",{className:"time-row"}),this.props.tableData.providers.map((function(e,t){return Object(C.jsx)("div",{className:"weather-row",children:Object(C.jsx)(L.a,{className:"weather-provider-name",children:e.name})},t)}))]}),Object(C.jsxs)("div",{className:"divider-column",children:[Object(C.jsx)("div",{className:"time-row"}),this.props.tableData.providers.map((function(e,t){return Object(C.jsx)("div",{className:"weather-row",children:Object(C.jsx)(M.a,{type:"vertical",style:{height:"calc(100% - 5px)",margin:0}})},t)}))]}),Object(C.jsxs)("div",{className:"right-column",style:{overflowX:"auto"},children:[Object(C.jsx)("div",{className:"time-row",style:{justifyContent:this.props.justifyRight?"flex-end":"space-around"},children:this.props.tableData.columns.map((function(e,t){return Object(C.jsx)(A,{time:e.date},t)}))}),this.props.tableData.providers.map((function(t,r){return Object(C.jsx)("div",{className:"weather-row",style:{justifyContent:e.props.justifyRight?"flex-end":"space-around"},children:e.props.tableData.columns.map((function(e,r){return Object(C.jsx)(F,{weather:e.weatherMap.get(t)},r)}))},r)}))]})]})]})}}]),r}(s.a.Component)),I=P;r(117);function H(e,t,r){for(var a=[],n=0;n<r;n++)a.push(new Date(e.getTime()+n*t));return a}function U(e){var t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0);var r=e.getTime()-t.getTime();return Math.floor(r/864e5)}var q=function(e){Object(l.a)(r,e);var t=Object(h.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"getTableData",value:function(){for(var e=[],t=this.props.weatherStateForecasts,r=t.map((function(e){return e.weatherProvider})),a=0;a<t.length;a++){var n=t[a];if(!n.loading)for(var s=0;s<n.forecast.weatherPoints.length;s++){var c=n.forecast.weatherPoints[s],o=void 0,i=U(o="string"===typeof c.time?new Date(c.time):c.time);if(i<0)console.warn("Old weather data");else{i>=e.length&&e.push({columns:[],providers:r});var u=e[i],l=o.getTime();0===u.columns.length&&u.columns.push({date:o,weatherMap:new Map});for(var h=u.columns.length-1;h>=0;h--){var d=u.columns[h],p=d.date.getTime();if(p===l){d.weatherMap.set(n.weatherProvider,c.weather);break}p<l&&(u.columns.splice(h+1,0,{date:o,weatherMap:new Map}),h+=2)}}}}return e}},{key:"getTableName",value:function(e,t){var r="";if(!t)return r;switch(e){case 0:r+="Idag, ";break;case 1:r+="Imorgon, "}switch(t.getDay()){case 1:r+="M\xe5ndag";break;case 2:r+="Tisdag";break;case 3:r+="Onsdag";break;case 4:r+="Torsdag";break;case 5:r+="Fredag";break;case 6:r+="L\xf6rdag";break;case 0:r+="S\xf6ndag"}return r}},{key:"render",value:function(){var e=this,t=this.getTableData();return Object(C.jsx)("div",{className:"list",children:t.map((function(t,r){return Object(C.jsx)(I,{tableData:t,justifyRight:0==r,name:e.getTableName(r,t.columns.length?t.columns[0].date:void 0)},r)}))})}}]),r}(s.a.Component),J=r(20),W=r(70),X=r(217),Y=r(215),B=r(110),z="UPDATE_USER_LOCATION",G="SELECT_LOCATION",V="SEARCH_START",$="SEARCH_SUCCESS",K="SEARCH_FAILURE",Q=Date.now(),Z="";function ee(e){return{type:$,results:e}}function te(e){return{type:K,errorMessage:e}}function re(e,t){Date.now()<Q||function(e,t){ae.apply(this,arguments)}(e,t)}function ae(){return(ae=Object(b.a)(f.a.mark((function e(t,r){var a,n,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"pk.4b179e38c5f1f5a80ad572c3bb3c0309","https://api.locationiq.com/v1/autocomplete.php",e.next=4,fetch("".concat("https://api.locationiq.com/v1/autocomplete.php","?key=").concat("pk.4b179e38c5f1f5a80ad572c3bb3c0309","&q=").concat(t,"&accept-language=sv"));case 4:return a=e.sent,e.next=7,a.json();case 7:n=e.sent,a.ok?(s=ne(n),r(ee(s))):"Unable to geocode"==n.error?r(ee([])):(console.error("Geocode response error! status: "+a.statusText),r(te(a.status.toString())));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ne(e){var t=[];try{var r,a=Object(B.a)(e);try{for(a.s();!(r=a.n()).done;){var n=r.value;t.push({country:n.display_address,name:n.display_place,lat:Number(n.lat),long:Number(n.lon),alt:0})}}catch(s){a.e(s)}finally{a.f()}return console.log(t),t}catch(c){return console.error(c),[]}}var se=X.a.Option,ce=L.a.Text,oe=function(e){Object(l.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(i.a)(this,r),(a=t.call(this,e)).state={searchText:""},a.handleTextChange=a.handleTextChange.bind(Object(W.a)(a)),a}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){var r={country:"",name:"Your Location",lat:t.coords.latitude,long:t.coords.longitude,alt:t.coords.altitude?t.coords.altitude:0};e.props.updateUserLocation(r),e.props.selectLocation(r),e.props.fetchForecasts(r)}),(function(e){}))}},{key:"handleTextChange",value:function(e){this.setState(Object(J.a)(Object(J.a)({},this.state),{},{searchText:e}))}},{key:"handleSearch",value:function(e){e&&this.props.searchLocations(e)}},{key:"handleSelect",value:function(e){for(var t=this.props.locationResults,r=0;r<t.length;r++)if(t[r].name===e){this.props.selectLocation(t[r]),this.props.fetchForecasts(t[r]);break}}},{key:"render",value:function(){var e=this,t=[];if(this.props.isLoading)t.push(ie(Object(C.jsx)(Y.a,{}),"spin",0));else if(this.props.errorMessage)t.push(ie(Object(C.jsxs)(ce,{type:"danger",children:["Error! Response status: ",this.props.errorMessage]}),"error",0));else if(0===this.props.locationResults.length)t.push(ie(Object(C.jsx)(ce,{children:"No locations found."}),"no locations",0));else for(var r=this.props.locationResults,a=0;a<r.length;a++){var n=r[a];t.push(ie(Object(C.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[Object(C.jsxs)(ce,{strong:!0,children:[n.name,"  "]}),Object(C.jsx)(ce,{type:"secondary",children:n.country})]}),n.name,a))}return Object(C.jsx)(X.a,{showSearch:!0,style:this.props.style,value:this.state.searchText?this.state.searchText:void 0,placeholder:"S\xf6k",size:"large",defaultActiveFirstOption:!1,showArrow:!1,filterOption:!1,onSearch:function(t){return e.handleSearch(t)},onChange:function(t){return e.handleTextChange(t)},onSelect:function(t){return e.handleSelect(t)},notFoundContent:null,children:t})}}]),r}(s.a.Component);function ie(e,t,r){return Object(C.jsx)(se,{value:t,children:e},r)}var ue=Object(d.b)((function(e){return{selectedLocation:e.locationSearch.selectedLocation,locationResults:e.locationSearch.searchResults,isLoading:e.locationSearch.isLoading,errorMessage:e.locationSearch.errorMessage}}),(function(e){return{selectLocation:function(t){return e(function(e){return{type:G,selectedLocation:e}}(t))},searchLocations:function(t){return e(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(r){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((a=e.trim())!==Z){t.next=3;break}return t.abrupt("return");case 3:Z=a,r({type:V}),Q=Date.now()+1e3,setTimeout((function(){return re(e,r)}),1001);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},fetchForecasts:function(t){return e(function(e){return function(){var t=Object(b.a)(f.a.mark((function t(r){var a,n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=function(e,t){return r(T(e,t))},n=function(e,t){return r(N(e,t.message))},_().forEach((function(t){r(S(t)),t.fetchForecast(e,(function(e){return a(t,e)}),(function(e){return n(t,e)}))}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))},updateUserLocation:function(t){return e(function(e){return{type:z,location:e}}(t))}}}))(oe),le=function(e){Object(l.a)(r,e);var t=Object(h.a)(r);function r(){return Object(i.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){return console.log("Render!!"),Object(C.jsxs)("div",{children:[Object(C.jsx)(ue,{style:{width:"100%"}}),Object(C.jsx)(q,{weatherStateForecasts:this.props.weatherStateForecasts})]})}}]),r}(s.a.Component);var he=Object(d.b)((function(e){return{location:e.locationSearch.selectedLocation,displayTimes:e.forecasts.displayTimes,weatherStateForecasts:e.forecasts.weatherStateForecasts}}),(function(e){return{setDisplayTimes:function(t){return e({type:g,displayTimes:t})}}}))(le);var de=function(){return Object(C.jsx)("div",{id:"app",children:Object(C.jsx)("div",{className:"page",children:Object(C.jsx)(he,{})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var pe=r(59),fe={selectedLocation:void 0,searchResults:[],isLoading:!1,errorMessage:"",userLocation:void 0};var be=r(113),ve={weatherStateForecasts:function(){var e=[];return _().forEach((function(t){var r={weatherProvider:t,loading:!0,forecast:{weatherPoints:[]}};e.push(r)})),console.log("Initial forecasts:",e),e}(),displayTimes:function(e){var t=new Date;return t.setHours(t.getHours()+1),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),H(t,36e5,e)}(24),nothing:1};var je=Object(pe.b)({locationSearch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(J.a)(Object(J.a)({},e),{},{userLocation:t.location});case G:return Object(J.a)(Object(J.a)({},e),{},{selectedLocation:t.selectedLocation});case V:return Object(J.a)(Object(J.a)({},e),{},{isLoading:!0});case $:return Object(J.a)(Object(J.a)({},e),{},{isLoading:!1,searchResults:t.results,errorMessage:""});case K:return Object(J.a)(Object(J.a)({},e),{},{isLoading:!1,searchResults:[],errorMessage:t.errorMessage});default:return e}},forecasts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return console.log("Fetch start!!"),void 0!==(a=(r=JSON.parse(JSON.stringify(e.weatherStateForecasts))).find((function(e){return e.weatherProvider.name===t.provider.name})))&&(a.loading=!0),Object(J.a)(Object(J.a)({},e),{},{weatherStateForecasts:r});case j:var r,a;return console.log("Fetch success!!"),void 0!==(a=(r=JSON.parse(JSON.stringify(e.weatherStateForecasts))).find((function(e){return e.weatherProvider.name===t.provider.name})))&&(a.loading=!1,a.forecast=t.forecast),Object(J.a)(Object(J.a)({},e),{},{weatherStateForecasts:r});case m:return console.log("Fetch fail"),Object(J.a)({},e);default:return e}}}),me=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||pe.c,ge=Object(pe.d)(je,{},Object(pe.c)(Object(pe.a)(be.a),me()));o.a.render(Object(C.jsx)(d.a,{store:ge,children:Object(C.jsx)(de,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[212,1,2]]]);
//# sourceMappingURL=main.38141f83.chunk.js.map